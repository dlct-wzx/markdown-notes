# 计网常用协议

[TOC]

**一、数据链路层的协议**
--------------

### **1、点对点协议 PPP**

点对点协议 PPP 是目前使用最广泛的[数据链路层](https://so.csdn.net/so/search?q=%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82&spm=1001.2101.3001.7020)协议

1.1、PPP 协议的特点

（1）支持异步链路，也支持面向比特的同步链路。

（2）PPP 是面向字节的协议。

1.2、PPP 协议组成

（1）一个将 IP 数据报封装到串行链路的方法

（2）一个用来建立、配置和测试数据链路连接的链路控制协议 LCP

（3）一套网络控制协议 NCP

1.3、PPP 协议帧格式

PPP 帧的首部和尾部分别为四个字段和两个字段, 首部的第一个字段和尾部的第二个字段都是标志字段，标志字段也称为帧定界符，连续两个帧之间只需要一个标志字段，如果出现了两个标志字段，则丢弃，数据部分的长度不超过 1500 字节

1.4、PPP 协议的字节填充和零比特填充

（1）字节填充：用于 PPP 的异步传输

（2）零比特填充：用于 PPP 的同步传输，在发送端先进行扫描字段，如果发现 5 个连续的 1，则填充一个 0。在接收端先找到标志字段 F，并用硬件对比特流进行扫描，当发现 5 个连续的 1 时，就把 1 后面的 0 删除，还原原来的比特信息，保证了透明传输。

### **2、CSMA/CD 协议**

2.1、以太网中的两种重要措施

1. 采用较为灵活的无连接的工作方式：即不必先建立连接就可以发信数据，适配器对发送的数据帧不进行编号，也不要求对方发回确认，以太网提供的服务是不可靠的交付，即尽最大努力的交付当目的站收到有差错的数据帧时就丢弃此帧，其他什么也不做。差错的纠正由高层来决定

2. 以太网发送的数据都使用曼彻斯特 (Manchester) 编码

2.2、CSMA/CD 协议的要点

多点接入，载波监听，碰撞检测

*   多点接入: 计算机以多点接入的方式连接在一条总线上
*   载波监听：不管在想要发送数据之前，还是在发送数据之中，每个站都必须不停地检测信道
*   碰撞检测：是适配器边发送数据边检测信道上信号的电压变化情况，当检测到电压变化超过了一定的门限值，认为产生了碰撞，一旦出现碰撞，适配器立即停止发送数据，等待一段时间再发送

2.3、CSMA/CD 工作流程图：

![](https://img-blog.csdnimg.cn/e51632a7e27644cd8c4d7b03a6b0b2e2.jpg?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5YeJ5rKrbG92ZQ==,size_20,color_FFFFFF,t_70,g_se,x_16)

2.4、传播时延对碰撞检测的影响

CSMA/CD 协议中，一个站点不可能同时发送和接收（但必须边发送边监听信道），CSMA/CD 协议的以太网不可能进行全双工通信，只能进行双向交替通信（半双工通信）

**注意：**如果一个信道 2T 时间内未检测到发生碰撞，则这次数据传输不会再发送碰撞（T 为总线端到端的传播时延）

2.5、如何确定重传时间

使用截断二进制指数退避算法

其中以太网规定最短帧长为 64 字节，即 512 比特（1 字节 = 8 比特）则收到的数据长度凡是小于 64 字节的帧都是由于冲突而异常中止的无效帧

**二、网络层的协议**
------------

### **1、ARP 地址解析协议**

1.1、[ARP](https://so.csdn.net/so/search?q=ARP&spm=1001.2101.3001.7020) 地址解析协议的作用：实现 IP 地址到 MAC 地址的映射

1.2、ARP 地址解析协议的要点

IP 地址为 32 位，MAC 地址为 48 位，每一台主机都设有一个 ARP 高速缓存，里面有本局域网的各主机或路由器的 IP 地址到 MAC 地址的映射表

1.3、ARP 地址解析协议的过程

当主机 A 向本局域网上的某台主机 B 发送 IP 数据报时，就先在其 ARP 高速缓存中查看有无主机 B 的 IP 地址。如有，就在 ARP 高速缓存中查出其对应的硬件地址，再把这个硬件地址写入 MAC 帧，然后通过局域网把该 MAC 帧发往此硬件地址。  
也有可能查不到主机 B 的 IP 地址。这可能主机 B 才入网，或者主机 A 刚刚加电，其高速缓存还是空的。这种情况下，主机 A 自动运行 ARP，然后按照以下步骤找出主机 B 的硬件地址。

1.  ARP 进程在本局域网上广播一个 ARP 请求分组。ARP 请求中包括源主机和目的主机的 IP 地址、源主机的 MAC 地址
2.  本局域网所有主机运行的 ARP 进程收到此 ARP 请求分组。
3.  主机 B 的 IP 与请求分组里面的 IP 一致，就收下 ARP 请求分组，并向主机 A 发送 ARP 响应分组，同时在响应分组中写入自己的 MAC 地址
4.  主机 A 收到从主机 B 发来的 ARP 响应分组时，就在其 ARP 高速缓存中写入主机 B 的 IP 地址到硬件地址的映射。本机缓存是有生存期的，生存期结束后，将再次重复上面的过程。主机 B 的 MAC 地址一旦确定，主机 A 就能向主机 B 发送 IP 通信了。

**注意：**ARP 用于解决同一局域网的主机或路由器的 IP 地址和 MAC 地址的映射，如果所要找的主机和源主机不在同一个局域网，则源主机发送 ARP 请求分组，找到本局域网上的一个路由器 R1 的硬件地址。剩下的工作由 R1 完成。

### **2、ICMP 网际报文控制协议**

2.1、ICMP 协议的作用：为了更有效的转发 IP 数据报和提高交付成功的机会

2.2、ICMP 报文的种类

(1)ICMP 差错报告报文

(2)ICMP 询问报文：包括回送请求或回送回答、时间戳请求或时间戳回答，其中 PING 命令利用的是回送请求或回送回答报文来测试两台主机之间的连通性

### **3、RIP 路由信息协议**

3.1、RIP 协议简介

是一种分布式的**基于距离向量的路由选择协议**，最大的优点是简单，要求网络中的每一个路由器都要维护从它自己到其他每一个目的网络的距离记录（**距离向量**），并规定距离等于 16 相当于不可达。

3.2、RIP 协议的特点

 RIP 协议考虑了和哪些路由器交换信息、交换什么信息以及什么时候交换信息这三个问题，RIP 协议特点：

*   仅和相邻路由器交换信息。
*   交换的信息是当前本路由器所知道的全部信息，即自己现在路由表。
*    按固定的时间间隔交换信息，如每隔 30s 或网络拓扑发生变化时。

3.3、距离向量算法

 对每一个相邻路由器发送过来的 RIP 报文，会进行一下步骤：

(1) 路由器 R1 接收到其相邻路由器 R2 发送过来的报文，先修改此报文的所有项目：把 “下一条” 字段中的地址都改为 R2，并把所有的 “距离” 字段的值加 1。每个项目都有三个关键字段：到目的网络 _N_，距离是 _d_，下一跳路由器是 _X_。

(2) 对修改后的 RIP 报文中的每一项，进行以下步骤：

*   若原来的路由表中没有网络 N，则把该项目添加到路由表中
*   如果 R1 路由表中已经有目的网络 N，这时查看下一跳的地址，如果下一跳地址是 R2，则把收到 的项目替换原路由表中的项目。
*   如果下一跳的地址不是 R2，那么如果收到项目中距离小于路由表中的距离，则进行替换，否则什么也不做。

 (3) 若 3 分钟还没有收到相邻路由器的更新路由表，则把此路由器记为不可达的距离，即把距离设置为 16。

### **4、OSPF 协议**

4.1、[OSPF](https://so.csdn.net/so/search?q=OSPF&spm=1001.2101.3001.7020) 协议的特点：

OSPF 最主要的特征就是使用链路状态协议，也需要考虑三个问题：哪些路由器交换信息、交换什么信息以及什么时候交换信息

*   采用洪泛法向本自治系统中所有路由器发送信息。
*   发送的信息就是与本路由器相邻的所有路由器的链路状态
*   当链路状态发生变化或每隔一段时间（30 分钟），路由器向所有路由器用洪泛法发送链路状态信息

由于路由器之间频繁的交换着链路状态信息，因此所有的路由器最终都能建立一个链路状态数据库，也称全网的拓扑结构图，每一个路由器都知道全网共有多少路由器，以及哪些路由器是相连的，并构建出自己的路由表。

**三、运输层的协议**
------------

### **1、TCP 传输控制协议**

1.1、TCP 协议的主要功能

*   完成对数据报的确认、流量控制和网络拥塞；
*   自动检测数据报，并提供错误重发的功能；
*   将多条路径传送的数据报按照原来的顺序进行排列；
*   控制超时重发，自动调整超时值

1.2、TCP 协议的特点

*   面向连接的运输层协议
*   每一条 TCP 连接只能有两个端点，每一条 TCP 连接只能是点对点的
*   TCP 提供可靠交互的服务
*   TCP 提供全双工通信
*   面向字节流

### **2、UDP 用户数据报协议**

2.1、[UDP](https://so.csdn.net/so/search?q=UDP&spm=1001.2101.3001.7020) 协议的主要功能

用户 UDP 只在用户的 IP 数据报服务之上增加了复用和分用，以及差错检测功能

2.2、UDP 协议的特点

*   UDP 是无连接的，即发送数据之前不需要建立连接
*   UDP 使用尽最大努力交付，即不保证可靠交互
*   UDP 面向报文的
*   UDP 没有拥塞控制
*   UDP 支持一对一，一对多，多对一和多对多的交互通信
*   UDP 首部开销小

**四、应用层的协议**
------------

### **1、域名系统 DNS**

域名系统是互联网使用的命名系统，用来便于把人们使用的机器名字转换为 IP 地址。

1.1、互联网域名的结构

互联网采用层次树状结构的命名方法，每一个域名都有标号序列组成，各标号用用点 (.) 隔开，域名中的标号都是由数字和字母组成。

例如：mail.cctv.com

三级域名 . 二级域名 . 顶级域名

1.2、顶级域名的分类

（1）国家顶级域名：如 cn(中国)、us(美国),uk(英国）等等

（2）通用顶级域名：如 com(公司企业)、net(网络服务机构)、org（非营利性组织）、int（国际组织）、edu（教育机构）、gov（政府部门）等等

（3）基础结构域名：只有一个 arpa, 用于反向域名解析，因此又称为反向域名

1.3、域名服务器的分类

（1）根域名服务器

（2）顶级域名服务器

（3）权限域名服务器

（4）本地域名服务器

### **2、HTTP 超文本传输协议**

超文本传输协议 (HTTP) 是一组说明如何在网络上交换信息的规则，该协议使 Web 浏览器和 Web 服务器能够使用 ISO Latin1 字母表进行通信。

### **3、FTP 文件传送协议**

文件传送协议 FTP 曾是互联网上使用最广泛的文件传输协议，基于的传输协议是 TCP，FTP 客户端和服务器之间的连接是可靠的，面向连接的，为数据的传输提供了可靠的保证。

### **4、SMTP 简单邮件传送协议**

[SMTP](https://so.csdn.net/so/search?q=SMTP&spm=1001.2101.3001.7020) 规定了在两个互相通信的 SMTP 进程之间应如何交换信息。由于 SMTP 采用 C/S 格式，因此负责发送邮件的 SMTP 进程就是 SMTP 客户，而负责接受邮件的 SMTP 进程就是 SMTP 服务器。

传送分为三步：（1）连接建立（2）邮件传送（3）连接释放